USE Baitap1
GO

CREATE TABLE LOAIMATHANG(
MaLoaiMatHang VARCHAR(20) NOT NULL PRIMARY KEY,
TenLoaiMatHang NVARCHAR(255) NULL,
)
GO

CREATE TABLE KHUVUC(
    MaKhuVuc NVARCHAR(20) NOT NULL,
    TenKhuVuc NVARCHAR(255) NOT NULL,
    PRIMARY KEY(MaKhuVuc),
)
GO

CREATE TABLE KHOANGTHOIGIAN(
    MaKhoangThoiGianGiaoHang NVARCHAR(10) NOT NULL,
    MoTa VARCHAR(255) NOT NULL,
    PRIMARY KEY(MaKhoangThoiGianGiaoHang),
)
GO
CREATE TABLE DICHVU(
    MaDichVu NVARCHAR(10) NOT NULL,
    TenDichVu VARCHAR(255) NOT NULL,
    PRIMARY KEY(MaDichVu),
) 
GO

CREATE TABLE THANHVIENGIAOHANG(
    MaThanhVienGiaoHang NVARCHAR(10) NOT NULL,
    TenThanhVienGiaoHang NVARCHAR(50) NOT NULL,
    NgaySinh DATETIME NOT NULL,
    GioiTinh CHAR(3) NOT NULL,
    SDTThanhVien VARCHAR(15) NOT NULL,
    DiaChiThanhVien NVARCHAR(255) NOT NULL,
    PRIMARY KEY(MaThanhVienGiaoHang),
)
GO

CREATE TABLE DANGKYGIAOHANG(
    MaThanhVienGiaoHang NVARCHAR(10) NOT NULL,
    MaKhoangThoiGianGiaoHang NVARCHAR(10) NOT NULL,
    PRIMARY KEY (MaThanhVienGiaoHang, MaKhoangThoiGianGiaoHang),
    FOREIGN KEY (MaThanhVienGiaoHang) REFERENCES THANHVIENGIAOHANG(MaThanhVienGiaoHang),
    FOREIGN KEY (MaKhoangThoiGianGiaoHang) REFERENCES KHOANGTHOIGIAN(MaKhoangThoiGianGiaoHang),
)
GO

CREATE TABLE KHACHHANG(
    MaKhachHang NVARCHAR(10) NOT NULL,
    MaKhuVuc NVARCHAR(20) NOT NULL,
    TenKhachHang NVARCHAR(50) NOT NULL,
    TenCuaHang NVARCHAR(50) NOT NULL,
    SDTKhachHang VARCHAR(15) NOT NULL,
    DiaChiEmail NVARCHAR(255) NOT NULL,
    DiaChiNhanHang NVARCHAR(255) NOT NULL,
    PRIMARY KEY (MaKhachHang),
    FOREIGN KEY (MaKhuVuc) REFERENCES KHUVUC(MaKhuVuc),
)
GO

CREATE TABLE DONHANGGIAOHANG(
    MaDonHangGiaoHang CHAR(10) NOT NULL,
    MaKhachHang NVARCHAR(10) NOT NULL,
    MaThanhVienGiaoHang NVARCHAR(10) NOT NULL,
    MaDichVu NVARCHAR(10) NOT NULL,
	MaKhuVucGiaoHang NVARCHAR(10) NOT NULL,
    TenNguoiNhan NVARCHAR(50) NOT NULL,
    DiaChiGiaoHang NVARCHAR(255) NOT NULL,
    SDTNguoiNhan VARCHAR(15) NOT NULL,
    MaKhoangThoiGianGiaoHang NVARCHAR(10) NOT NULL,
    NgayGiaoHang DATE NOT NULL,
    PhuongThucThanhToan NVARCHAR(20) NOT NULL,
    TrangThaiPheDuyet VARCHAR(20) NOT NULL,
    TrangThaiGiaoHang NVARCHAR(10) NOT NULL,
    PRIMARY KEY (MaDonHangGiaoHang),
    FOREIGN KEY (MaKhachHang) REFERENCES KHACHHANG(MaKhachHang),
    FOREIGN KEY (MaThanhVienGiaoHang) REFERENCES THANHVIENGIAOHANG(MaThanhVienGiaoHang),
    FOREIGN KEY (MaDichVu) REFERENCES DICHVU(MaDichVu),
    FOREIGN KEY (MaKhoangThoiGianGiaoHang) REFERENCES KHOANGTHOIGIAN(MaKhoangThoiGianGiaoHang),
)
GO

CREATE TABLE CHITIETDONHANG(
    MaDonHangGiaoHang CHAR(10) NOT NULL,
    TenSanPhamDuocGiao NVARCHAR(255),
    SoLuong INT,
    TrongLuong FLOAT,
    MaLoaiMatHang VARCHAR(20) NOT NULL,
    TienThuHo DECIMAL(15, 2),
    PRIMARY KEY (MaDonHangGiaoHang, TenSanPhamDuocGiao),
    FOREIGN KEY (MaDonHangGiaoHang) REFERENCES DONHANGGIAOHANG(MaDonHangGiaoHang),
    FOREIGN KEY (MaLoaiMatHang) REFERENCES LOAIMATHANG(MaLoaiMatHang),
)
GO
